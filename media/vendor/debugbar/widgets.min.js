if(typeof PhpDebugBar>"u"){var PhpDebugBar={};PhpDebugBar.$=jQuery}(function(e){PhpDebugBar.Widgets={};var s=PhpDebugBar.utils.makecsscls("phpdebugbar-widgets-"),x=PhpDebugBar.Widgets.htmlize=function(t){return t.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")},_=PhpDebugBar.Widgets.renderValue=function(t,a){return typeof t!="string"?a?x(JSON.stringify(t,void 0,2)):JSON.stringify(t):t},W=PhpDebugBar.Widgets.highlight=function(t,a){return typeof t=="string"?typeof hljs>"u"?x(t):a&&hljs.getLanguage(a)?hljs.highlight(t,{language:a}).value:hljs.highlightAuto(t).value:(typeof hljs=="object"&&t.each(function(i,n){hljs.highlightElement(n)}),t)},v=PhpDebugBar.Widgets.createCodeBlock=function(t,a,i,n){var l=e("<pre />").addClass(s("code-block")),d=e("<code />").text(t+`
`).appendTo(l);if(a&&d.addClass("language-"+a),W(d).removeClass("hljs"),!isNaN(parseFloat(i))){var r=t.split(`
`).length,h=e("<ul />").prependTo(l);l.children().addClass(s("numbered-code"));for(var p=i;p<i+r;p++){var c=e("<li />").text(p).appendTo(h);n===p&&c.addClass(s("highlighted-line")).append("<span>&nbsp;</span>")}}return l},y=PhpDebugBar.utils.getDictValue=function(t,a,i){for(var n=t,l=a.split("."),d=0;d<l.length;d++){if(!n[l[d]])return i;n=n[l[d]]}return n},C=PhpDebugBar.Widgets.ListWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:s("list"),initialize:function(t){t.itemRenderer||(t.itemRenderer=this.itemRenderer),this.set(t)},render:function(){this.bindAttr(["itemRenderer","data"],function(){if(this.$el.empty(),!!this.has("data"))for(var t=this.get("data"),a=0;a<t.length;a++){var i=e("<li />").addClass(s("list-item")).appendTo(this.$el);this.get("itemRenderer")(i,t[a])}})},itemRenderer:function(t,a){t.html(_(a))}}),T=PhpDebugBar.Widgets.KVListWidget=C.extend({tagName:"dl",className:s("kvlist"),render:function(){this.bindAttr(["itemRenderer","data"],function(){if(this.$el.empty(),!!this.has("data")){var t=this;e.each(this.get("data"),function(a,i){var n=e("<dt />").addClass(s("key")).appendTo(t.$el),l=e("<dd />").addClass(s("value")).appendTo(t.$el);t.get("itemRenderer")(n,l,a,i)})}})},itemRenderer:function(t,a,i,n){t.text(i),a.html(x(n))}}),j=PhpDebugBar.Widgets.VariableListWidget=T.extend({className:s("kvlist varlist"),itemRenderer:function(t,a,i,n){e("<span />").attr("title",i).text(i).appendTo(t);var l=n&&n.value||n;l&&l.length>100&&(l=l.substr(0,100)+"...");var d=null;a.text(l).click(function(){a.hasClass(s("pretty"))?a.text(l).removeClass(s("pretty")):(d=d||v(n),a.addClass(s("pretty")).empty().append(d))})}}),S=PhpDebugBar.Widgets.HtmlVariableListWidget=T.extend({className:s("kvlist htmlvarlist"),itemRenderer:function(t,a,i,n){if(e("<span />").attr("title",e("<i />").html(i||"").text()).html(i||"").appendTo(t),a.html(n&&n.value||n),n&&n.xdebug_link){var l=e("<span />").addClass(s("filename")).text(n.xdebug_link.filename+(n.xdebug_link.line?"#"+n.xdebug_link.line:""));n.xdebug_link&&(n.xdebug_link.ajax?e('<a title="'+n.xdebug_link.url+'"></a>').on("click",function(){e.ajax(n.xdebug_link.url)}).addClass(s("editor-link")).appendTo(l):e('<a href="'+n.xdebug_link.url+'"></a>').addClass(s("editor-link")).appendTo(l)),l.appendTo(a)}}}),A=PhpDebugBar.Widgets.IFrameWidget=PhpDebugBar.Widget.extend({tagName:"iframe",className:s("iframe"),render:function(){this.$el.attr({seamless:"seamless",border:"0",width:"100%",height:"100%"}),this.bindAttr("data",function(t){this.$el.attr("src",t)})}}),E=PhpDebugBar.Widgets.MessagesWidget=PhpDebugBar.Widget.extend({className:s("messages"),render:function(){var t=this;this.$list=new C({itemRenderer:function(a,i){if(i.message_html)var n=e("<span />").addClass(s("value")).html(i.message_html).appendTo(a);else{var l=i.message;l.length>100&&(l=l.substr(0,100)+"...");var n=e("<span />").addClass(s("value")).text(l).appendTo(a);if(!i.is_string||i.message.length>100){var d=i.message;i.is_string||(d=null),a.css("cursor","pointer").click(function(){if(window.getSelection().type=="Range")return"";n.hasClass(s("pretty"))?n.text(l).removeClass(s("pretty")):(d=d||v(i.message,"php"),n.addClass(s("pretty")).empty().append(d))})}}if(i.xdebug_link){var r=e("<span />").addClass(s("filename")).text(i.xdebug_link.filename+(i.xdebug_link.line?"#"+i.xdebug_link.line:""));i.xdebug_link&&(i.xdebug_link.ajax?e('<a title="'+i.xdebug_link.url+'"></a>').on("click",function(){e.ajax(i.xdebug_link.url)}).addClass(s("editor-link")).appendTo(r):e('<a href="'+i.xdebug_link.url+'"></a>').addClass(s("editor-link")).appendTo(r)),r.appendTo(a)}i.collector&&e("<span />").addClass(s("collector")).text(i.collector).prependTo(a),i.label&&(n.addClass(s(i.label)),e("<span />").addClass(s("label")).text(i.label).prependTo(a))}}),this.$list.$el.appendTo(this.$el),this.$toolbar=e('<div><i class="phpdebugbar-fa phpdebugbar-fa-search"></i></div>').addClass(s("toolbar")).appendTo(this.$el),e('<input type="text" name="search" aria-label="Search" placeholder="Search" />').on("change",function(){t.set("search",this.value)}).appendTo(this.$toolbar),this.bindAttr("data",function(a){this.set({excludelabel:[],excludecollector:[],search:""}),this.$toolbar.find(s(".filter")).remove();var i=[],n=[],l=this,d=function(r,h){e("<a />").addClass(s("filter")).addClass(s(r)).text(h).attr("rel",h).on("click",function(){l.onFilterClick(this,r)}).appendTo(l.$toolbar)};a.forEach(function(r){i.includes(r.label||"none")||i.push(r.label||"none"),n.includes(r.collector||"none")||n.push(r.collector||"none")}),i.length>1&&i.forEach(r=>d("label",r)),n.length!==1&&(e("<a />").addClass(s("filter")).css("visibility","hidden").appendTo(l.$toolbar),n.forEach(r=>d("collector",r)))}),this.bindAttr(["excludelabel","excludecollector","search"],function(){var a=this.get("excludelabel")||[],i=this.get("excludecollector")||[],n=this.get("search"),l=!1,d=[];n&&n===n.toLowerCase()&&(l=!0),this.get("data").forEach(function(r){var h=l?r.message.toLowerCase():r.message;!a.includes(r.label||void 0)&&!i.includes(r.collector||void 0)&&(!n||h.indexOf(n)>-1)&&d.push(r)}),this.$list.set("data",d)})},onFilterClick:function(t,a){e(t).toggleClass(s("excluded"));var i=[];this.$toolbar.find(s(".filter")+s(".excluded")+s("."+a)).each(function(){i.push(this.rel==="none"||!this.rel?void 0:this.rel)}),this.set("exclude"+a,i)}}),F=PhpDebugBar.Widgets.TimelineWidget=PhpDebugBar.Widget.extend({tagName:"ul",className:s("timeline"),render:function(){this.bindAttr("data",function(t){var a=function(o){return o<.001?(o*1e6).toFixed()+"\u03BCs":o<.1?(o*1e3).toFixed(2)+"ms":o<1?(o*1e3).toFixed()+"ms":o.toFixed(2)+"s"},i=function(b){if(b===0||b===null)return"0B";var w=b<0?"-":"",b=Math.abs(b),k=Math.log(b)/Math.log(1024),R=["B","KB","MB","GB","TB"];return w+Math.round(Math.pow(1024,k-Math.floor(k))*100)/100+R[Math.floor(k)]};if(this.$el.empty(),t.measures){for(var n={},l=0;l<t.measures.length;l++){var d=t.measures[l];n[d.label]||(n[d.label]={count:0,duration:0,memory:0}),n[d.label].count+=1,n[d.label].duration+=d.duration,n[d.label].memory+=d.memory||0;var r=e("<div />").addClass(s("measure")),h=e("<li />"),p=(d.relative_start*100/t.duration).toFixed(2),c=Math.min((d.duration*100/t.duration).toFixed(2),100-p);if(r.append(e("<span />").addClass(s("value")).css({left:p+"%",width:c+"%"})),r.append(e("<span />").addClass(s("label")).text(d.label+" ("+d.duration_str+(d.memory?"/"+d.memory_str:"")+")")),d.collector&&e("<span />").addClass(s("collector")).text(d.collector).appendTo(r),r.appendTo(h),this.$el.append(h),d.params&&!e.isEmptyObject(d.params)){var g=e('<table><tr><th colspan="2">Params</th></tr></table>').hide().addClass(s("params")).appendTo(h);for(var m in d.params)typeof d.params[m]!="function"&&g.append('<tr><td class="'+s("name")+'">'+m+'</td><td class="'+s("value")+'"><pre><code>'+d.params[m]+"</code></pre></td></tr>");h.css("cursor","pointer").click(function(){if(window.getSelection().type=="Range")return"";var o=e(this).find("table");o.is(":visible")?o.hide():o.show()})}}n=e.map(n,function(o,f){return{label:f,data:o}}).sort(function(o,f){return f.data.duration-o.data.duration});var u=e("<table></table>").addClass(s("params"));e.each(n,function(o,f){c=Math.min((f.data.duration*100/t.duration).toFixed(2),100),u.append('<tr><td class="'+s("name")+'">'+f.data.count+" x "+e("<i />").text(f.label).html()+" ("+c+'%)</td><td class="'+s("value")+'"><div class="'+s("measure")+'"><span class="'+s("value")+'"></span><span class="'+s("label")+'">'+a(f.data.duration)+(f.data.memory?"/"+i(f.data.memory):"")+"</span></div></td></tr>"),u.find("span."+s("value")+":last").css({width:c+"%"})}),this.$el.append("<li/>").find("li:last").append(u)}})}}),M=PhpDebugBar.Widgets.ExceptionsWidget=PhpDebugBar.Widget.extend({className:s("exceptions"),render:function(){this.$list=new C({itemRenderer:function(t,a){if(e("<span />").addClass(s("message")).text(a.message).appendTo(t),a.file){var i=e("<span />").addClass(s("filename")).text(a.file+"#"+a.line);a.xdebug_link&&(a.xdebug_link.ajax?e('<a title="'+a.xdebug_link.url+'"></a>').on("click",function(){fetch(a.xdebug_link.url)}).addClass(s("editor-link")).appendTo(i):e('<a href="'+a.xdebug_link.url+'"></a>').addClass(s("editor-link")).appendTo(i)),i.appendTo(t)}if(a.type&&e("<span />").addClass(s("type")).text(a.type).appendTo(t),a.surrounding_lines){var n=a.line-3<=0?1:a.line-3,l=v(a.surrounding_lines.join(""),"php",n,a.line).addClass(s("file")).appendTo(t);a.stack_trace_html||t.click(function(){l.is(":visible")?l.hide():l.show()})}if(a.stack_trace_html){var d=e("<span />").addClass(s("filename")).html(a.stack_trace_html);d.appendTo(t)}else a.stack_trace&&a.stack_trace.split(`
`).forEach(function(r){var h=e("<div />");e("<span />").addClass(s("filename")).text(r).appendTo(h),h.appendTo(t)})}}),this.$list.$el.appendTo(this.$el),this.bindAttr("data",function(t){this.$list.set("data",t),t.length==1&&this.$list.$el.children().first().find(s(".file")).show()})}}),N=PhpDebugBar.Widgets.DatasetWidget=PhpDebugBar.Widget.extend({initialize:function(t){t.itemRenderer||(t.itemRenderer=this.itemRenderer),this.set(t),this.set("autoshow",null),this.set("id",null),this.set("sort",localStorage.getItem("debugbar-history-sort")||"asc"),this.$el.addClass(s("dataset-history")),this.renderHead()},renderHead:function(){this.$el.empty(),this.$actions=e("<div />").addClass(s("dataset-actions")).appendTo(this.$el);var t=this;this.$autoshow=e("<input type=checkbox>").on("click",function(){t.get("debugbar").ajaxHandler&&t.get("debugbar").ajaxHandler.setAutoShow(e(this).is(":checked"))}),e("<label>Autoshow</label>").append(this.$autoshow).appendTo(this.$actions),this.$clearbtn=e("<a>Clear</a>").appendTo(this.$actions).on("click",function(){t.$table.empty()}),this.$showBtn=e("<a>Show all</a>").appendTo(this.$actions).on("click",function(){t.searchInput.val(null),t.methodInput.val(null),t.set("search",null),t.set("method",null)}),this.methodInput=e('<select name="method" style="width:100px"><option>(method)</option><option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option></select>').on("change",function(){t.set("method",this.value)}).appendTo(this.$actions),this.searchInput=e('<input type="text" name="search" aria-label="Search" placeholder="Search" />').on("input",function(){t.set("search",this.value)}).appendTo(this.$actions),this.$table=e("<tbody />"),e("<table/>").append(e("<thead/>").append(e("<tr/>").append(e("<th></th>").css("width","30px")).append(e("<th>Date \u2195</th>").css("width","175px").click(function(){t.set("sort",t.get("sort")==="asc"?"desc":"asc"),localStorage.setItem("debugbar-history-sort",t.get("sort"))})).append(e("<th>Method</th>").css("width","80px")).append(e("<th>URL</th>")).append(e('<th width="40%">Data</th>')))).append(this.$table).appendTo(this.$el)},renderDatasets:function(){this.$table.empty();var t=this;e.each(this.get("data"),function(a,i){i.__meta&&t.get("itemRenderer")(t,i)})},render:function(){this.bindAttr("data",function(){if(this.get("autoshow")===null&&this.get("debugbar").ajaxHandler&&this.set("autoshow",this.get("debugbar").ajaxHandler.autoShow),!!this.has("data")){var t=this.get("data"),a=t[Object.keys(t)[Object.keys(t).length-1]];a.__meta&&this.get("itemRenderer")(this,a)}}),this.bindAttr(["itemRenderer","search","method","sort"],function(){this.renderDatasets()}),this.bindAttr("autoshow",function(){var t=this.get("autoshow");this.$autoshow.prop("checked",t)}),this.bindAttr("id",function(){var t=this.get("id");this.$table.find("."+s("active")).removeClass(s("active")),this.$table.find("tr[data-id="+t+"]").addClass(s("active"))})},itemRenderer:function(t,a){var i=a.__meta,n=e("<td />"),l=e("<tr />");t.get("sort")==="asc"?l.appendTo(t.$table):l.prependTo(t.$table);var d=function(){var c=t.get("debugbar");c.showDataSet(i.id,c.datesetTitleFormater.format("",a,i.suffix,i.nb)),t.$table.find("."+s("active")).removeClass(s("active")),l.addClass(s("active")),e(this).data("tab")&&c.showTab(e(this).data("tab"))};l.attr("data-id",i.id).append(e("<td>#"+i.nb+"</td>").click(d)).append(e("<td>"+i.datetime+"</td>").click(d)).append(e("<td>"+i.method+"</td>").click(d)).append(e("<td />").append(i.uri+(i.suffix?" "+i.suffix:"")).click(d)).css("cursor","pointer").addClass(s("table-row"));var r=t.get("debugbar");e.each(r.dataMap,function(c,g){var m=y(a,g[0],g[1]);if(c.indexOf(":")!=-1&&(c=c.split(":"),c[1]==="badge"&&m>0)){var u=r.getControl(c[0]),o=e("<a>").attr("title",u.get("title")).data("tab",c[0]);u.$icon&&o.append(r.getControl(c[0]).$icon.clone()),u.$badge&&o.append(r.getControl(c[0]).$badge.clone().css("display","inline-block").text(m)),o.appendTo(n).click(d)}}),l.append(n),r.activeDatasetId===i.id&&l.addClass(s("active"));var h=t.get("search"),p=t.get("method");(h&&i.uri.indexOf(h)==-1||p&&i.method!==p)&&l.hide()}})})(PhpDebugBar.$);
